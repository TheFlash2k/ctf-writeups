#!/usr/bin/env python3

from pwn import *
context.terminal = ["tmux", "splitw", "-h"]
encode = lambda e: e if type(e) == bytes else str(e).encode()
hexleak = lambda l: int(l[:-1] if l[-1] == '\n' else l, 16)
fixleak = lambda l: unpack(l[:-1].ljust(8, b"\x00"))

def one_gadget(filename, base_addr=0):
	""" One Gadget extractor from nobodyisnobody """
	info("Extracting gadgets for %s with base @ %#x" % (filename, base_addr))
	gadgets = [(int(i)+base_addr) for i in subprocess.check_output(['one_gadget', '--raw', '-l1', filename]).decode().split(' ')]
	info("Extracted %d gadgets" % len(gadgets))
	return gadgets

exe = "./EXE"
elf = context.binary = ELF(exe)
libc = elf.libc
io = remote(sys.argv[1], int(sys.argv[2])) if args.REMOTE else process()
if args.GDB: gdb.attach(io, "b *main")



io.interactive()
